{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "http://liestudio/schemas/workflow_schema.json",
    "title": "Workflow",
    "description": "A default LIEStudio workflow",
    "type": "object",
    "properties": {
        "edge_attr": {},
        "graph": {
            "type": "object",
            "properties": {
                "title": {
                    "description": "Administrative title of the task",
                    "type": "string",
                    "default": "MDstudio workflow"
                },
                "description": {
                    "description": "Description of the task",
                    "type": "string",
                    "default": ""
                },
                "version": {
                    "description": "workflow version",
                    "type": "number",
                    "default": 1.0
                },
                "is_running": {
                    "description": "Is the workflow currently running or not",
                    "type": "boolean",
                    "default": false
                },
                "create_time": {
                    "description": "Workflow creation time stamp",
                    "type": "integer"
                },
                "update_time": {
                    "description": "Last workflow update time stamp",
                    "type": "integer"
                },
                "start_time": {
                    "description": "Workflow run start time stamp",
                    "type": "integer"
                },
                "node_data_tag": {
                    "description": "",
                    "type": "string",
                    "default": "task_name"
                },
                "is_directed": {
                    "description": "",
                    "type": "boolean",
                    "default": true,
                    "enum": [ true ]
                },
                "edge_data_tag": {
                    "description": "",
                    "type": "string",
                    "default": "label"
                },
                "is_masked": {
                    "description": "",
                    "type": "boolean",
                    "default": false
                },
                "root": {
                    "description": "",
                    "type": "integer",
                    "default": 1
                }, 
                "auto_nid": {
                    "description": "",
                    "type": "boolean",
                    "default": true
                }
            },
            "required": ["title", "description", "is_running", "is_directed", "root", "node_data_tag"]
        },
        "edges": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
                "^.*$": {
                    "allOf": [
                        {
                            "type": "array",
                            "minItems": 2,
                            "uniqueItems": true
                        }
                    ]
                }
            }
        },
        "nodes": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
                "^.*$": {
                    "type": "object",
                    "properties": {
                        "active": {
                            "description": "Is the current task active or not",
                            "type": "boolean",
                            "default": false
                        },
                        "breakpoint": {
                            "description": "Add a breakpoint for the task. The workflow will only continue if explicitly instructed",
                            "type": "boolean",
                            "default": false
                        },
                        "custom_func": {
                            "type": "string",
                            "description": "Custom Python function to run in a (local) task runner",
                            "pattern": "^\\w+(\\.\\w+)*$"
                        },
                        "data_mapping": {
                            "description": "Keyword mapping between output/input data attribute names",
                            "type": "object"
                        },
                        "input_data": {
                            "description": "All required input and optional configuration to the service as key/value pairs",
                            "type": "object",
                            "default": {}
                        },
                        "output_data": {
                            "description": "All output returned by the task",
                            "type": "object"
                        },
                        "replace_output": {
                            "description": "Number of times the task should be resubmitted when it failed",
                            "type": "boolean",
                            "default": false
                        },
                        "retry_count": {
                            "description": "Number of times the task should be resubmitted when it failed",
                            "type": "integer",
                            "default": 0
                        },
                        "session": {
                            "description": "Session specific data",
                            "type": "object"
                        },
                        "status": {
                            "description": "The status of the current task",
                            "type": "string",
                            "default": "ready",
                            "enum": ["ready","submitted","running","failed","aborted","completed","deactivated"]
                        },
                        "task_id": {
                            "type": "string",
                            "description": "Unique ID used to identify the task in the system"
                        },
                        "uri": {
                            "type": "string",
                            "description": "LIEStudio microservice method uri",
                            "pattern": "^\\w+(\\.\\w+)*$"
                        }
                    },
                    "required": ["active", "breakpoint", "replace_output", "retry_count", "status"]
                }
            }
        },
        "lie_graph_version": {
            "type": "string",
            "default": "1.0"
        }
    },      
    "required": ["lie_graph_version", "graph"]
}